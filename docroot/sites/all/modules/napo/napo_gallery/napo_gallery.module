<?php
/**
 * @file
 * Code for the Napo Gallery feature.
 */

include_once 'napo_gallery.features.inc';

/**
 * Implements hook_preprocess_node().
 */
function napo_gallery_preprocess_node(&$vars) {
  $node = $vars['node'];
  if ($node->type == 'napo_album') {
    $params = drupal_get_query_parameters();
    if (isset($params['page'])) {
      hide($vars['content']['field_image']);
    }
  }
}


/**
 * Implements hook_node_validate().
 */
function napo_gallery_node_validate($node, $form, &$form_state) {
  if ($node->type == 'napo_album') {
    // Limit the title field of the album to 50 chars.
    $lang = $form_state['values']['language'];
    if (strlen($form_state['values']['title_field'][$lang][0]['value']) > 50) {
      form_set_error('title_field', t('The album title should not be longer than 50 character!'));
    }
  }
}
